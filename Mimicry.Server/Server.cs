using Microsoft.Owin.Hosting;
using Mimicry.Interfaces;
using Newtonsoft.Json;
using Owin;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace Mimicry.Server
{
    public class EmbeddedServer : IDisposable
    {
        public event EventHandler<MimicInvocation> OnEnpointInvocation;
        public event EventHandler OnNotdefinedInvocation;
        public bool HitUndefinedUrl { get; private set; }
        public IEnumerable<MimicInvocation> InvocatedUrls { get { return Urls; } }
        private readonly List<MimicInvocation> Urls = new List<MimicInvocation>();
        public string BaseUrl { get; }
        IDisposable Wapp { get; set; }
        public IDictionary<Type, IMimicDefinitionLoader> MimicDefinitionLoaders { get; }
        public IEnumerable<IMimicDefinition> Definitions
        {
            get
            {
                return MimicDefinitionLoaders?.SelectMany(a => a.Value?.GetDefinitions());
            }
        }

        public void Dispose()
        {
            Wapp?.Dispose();
        }

        public EmbeddedServer(string relativeUrl, string response) : this(new DefaultDefinitionLoader(new DefaultMimicDefinition(relativeUrl, response)))
        {

        }
        public EmbeddedServer(IMimicDefinitionLoader loader, int port = 8080)
        {
            MimicDefinitionLoaders = new Dictionary<Type, IMimicDefinitionLoader>();
            var options = new StartOptions
            {
                ServerFactory = "Nowin",
                Port = port
            };

            MimicDefinitionLoaders.Add(typeof(RestApiMock), loader);

            Wapp = WebApp.Start(options, Configuration);

            BaseUrl = "http://localhost:" + options.Port;
        }

        public virtual void Configuration(IAppBuilder app)
        {
            app.Use(async (ctx, next) =>
            {
                var start = DateTime.Now;
                await next.Invoke();
                var end = DateTime.Now;

                var relativeUrl = ctx.Request.Uri.PathAndQuery;

                var definition = Definitions.FirstOrDefault(a => a.RelativeEndpointUrl == relativeUrl);
                if (definition == null)
                {
                    this.HitUndefinedUrl = true;
                    this.OnNotdefinedInvocation?.Invoke(this, null);
                }
                this.OnEnpointInvocation?.Invoke(this, new MimicInvocation() { MinicDefinition = definition ?? new DefaultMimicDefinition(relativeUrl, ""), TimeStamp = DateTime.Now, LoadTime = end - start });

            });

            foreach (var loader in MimicDefinitionLoaders)
            {
                var api = Activator.CreateInstance(loader.Key) as IApiMock;
                api.Load(loader.Value);

                foreach (IMimicDefinition definition in api.MinicDefinitions)
                {
                    app.Map(definition.RelativeEndpointUrl, map =>
                    {
                        map.Run(async ctx => await api.InvokeMimickedEndpoint(definition.RelativeEndpointUrl, ctx));
                    });
                }
            }

            #region optional endpoints
            app.Map("/favicon.ico", map =>
             {
                 map.Run(async ctx =>
                 {
                     ctx.Response.ContentType = "image/jpeg";
                     await ctx.Response.WriteAsync(Convert.FromBase64String("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"));
                 });
             });

            app.Run(async ctx =>
            {
                ctx.Response.StatusCode = 501;
                await ctx.Response.WriteAsync("Nothing here...");
            });
            #endregion endpoints
        }

        public bool Verify(string url, int nrOfTimes)
        {
            return InvocatedUrls?.Count(a => a.MinicDefinition.RelativeEndpointUrl == url) == nrOfTimes;
        }
    }
}